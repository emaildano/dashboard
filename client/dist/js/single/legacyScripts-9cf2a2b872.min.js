function securityFilter(e,t,o){try{return o()}finally{null!==cognitoUser?cognitoUser.getSession(function(e,o){e||(o.isValid()&&noLoginPages.indexOf(t.matches[1].tag)>=0?t.redirectTo="/projects":!o.isValid()&&noLoginPages.indexOf(t.matches[1].tag)<0&&(t.redirectTo="/"))}):noLoginPages.indexOf(t.matches[1].tag)<0&&(t.redirectTo="/")}}function init(){return getCognitoUserSession().then(function(){return getStatus()})}function getCognitoUserSession(){return new Promise(function(e,t){var o=userPool.getCurrentUser();o||location.reload(),o.getSession(function(o,n){if(o)return void t({statusCode:401,message:"Unauthorized"});session_id=n.getAccessToken().getJwtToken(),e(session_id)})})}function getStatus(){return get(endpoint.status).then(function(e){return maintenance=e.body.maintenance,userStatus=e.body.user,Promise.resolve()})}function get(e){return new Promise(function(t,o){request.get(e).set("Authorization",session_id).end(function(e,n){e&&o(e),t(n)})})}function post(e,t){var t=void 0===t?{}:t;return new Promise(function(o,n){request.post(e).set("Authorization",session_id).send(t).end(function(e,t){e&&n(e),o(t)})})}function put(e,t){var t=void 0===t?{}:t;return new Promise(function(o,n){request.put(e).set("Authorization",session_id).send(t).end(function(e,t){e&&n(e),o(t)})})}function del(e,t){var t=void 0===t?{}:t;return new Promise(function(o,n){request.del(e).set("Authorization",session_id).send(t).end(function(e,t){e&&n(e),o(t)})})}function display(){$("#loading").addClass("hidden"),$("#main_box").removeClass("hidden")}function loading(){function e(){var e=$(window).height(),t=$("#loading").offset(),o=t.top,n=e-o;$("#loading").height(n)}$("#loading").removeClass("hidden"),e(),$(window).resize(function(){e()})}function notifyUnregistedCreditCard(){swal({title:"Required",text:" Please register billing information to begin using Shifter.",confirmButtonColor:"#dc2d69",confirmButtonText:"Regist Credit Cards",showCancelButton:!0,closeOnConfirm:!0},function(e){e&&riot.route("/billing"),swal.close()})}function editable(e){$.fn.editable.defaults.mode="inline",$.fn.editable.defaults.ajaxOptions={type:"PUT",headers:{Authorization:session_id},dataType:"json"},$(e).editable()}if(AWSCognito.config.region="us-east-1","go.getshifter.io"===location.hostname)var poolData={UserPoolId:"us-east-1_OqeySRZoo",ClientId:"5mn2si2f0onlo063so26gk77j2"};else var poolData={UserPoolId:"us-east-1_Hq3FXXyA0",ClientId:"47fobgjl229cqj13cmhj18dajs"};var userPool=new AWSCognito.CognitoIdentityServiceProvider.CognitoUserPool(poolData),cognitoUser=userPool.getCurrentUser(),request=window.superagent,session_id,sessionRefrashProvider,maintenance,userStatus;if("go.getshifter.io"===location.hostname)var apigwId="hz0wknz3a2",stage="production";else if(location.pathname.indexOf("stg-shifter-userconsole")>0)var apigwId="49pfwvlis2",stage="staging";else var apigwId="mr2jj0imn9",stage="development";var endpoint={projects:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/projects/",containers:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/containers/",staticsites:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/staticsites/",archives:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/archives/",genhistory:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/generatehistory/",status:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/status/",transactions:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/transactions/",domains:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/domains/",billing:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/billings",coupon:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/coupons/",netlify:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/netlify/",accounts:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/accounts/",support:"https://"+apigwId+".execute-api.us-east-1.amazonaws.com/"+stage+"/support/"},noLoginPages=["login","not-found","activation","forgot_password","register","reset_password"];riot.compile(function(){riot.mount("*");var e=riot.router.Route,t=riot.router.DefaultRoute,o=riot.router.NotFoundRoute;riot.router.RedirectRoute;riot.router.use(securityFilter),riot.router.routes([new t({tag:"login"}),new e({tag:"projects"}),new e({path:"/project_new/:archive_id",tag:"project_new"}),new e({path:"/project_new",tag:"project_new"}),new e({path:"/project_detail/:project_id",tag:"project_detail"}),new e({tag:"archive"}),new e({tag:"billing"}),new e({path:"/activation/:username/:code",tag:"activation"}),new e({tag:"domains"}),new e({tag:"archive-tool"}),new e({path:"/userinfo-activation/:code",tag:"userinfo-activation"}),new e({tag:"register"}),new e({tag:"forgot_password"}),new e({path:"/reset_password/:username/:code",tag:"reset_password"}),new e({tag:"account"}),new o({tag:"not-found"})]),riot.router.start()}),null!==cognitoUser&&(sessionRefrashProvider=setInterval(function(){cognitoUser.getSession(function(e,t){e||(session_id=t.getAccessToken().getJwtToken())})},9e5));