function securityFilter(e,t,n){try{return n()}finally{null!==cognitoUser?cognitoUser.getSession(function(e,n){e||(n.isValid()&&noLoginPages.indexOf(t.matches[1].tag)>=0?t.redirectTo="/projects":!n.isValid()&&noLoginPages.indexOf(t.matches[1].tag)<0&&(t.redirectTo="/"))}):noLoginPages.indexOf(t.matches[1].tag)<0&&(t.redirectTo="/")}}function init(){return getCognitoUserSession().then(function(){return getStatus()})}function getCognitoUserSession(){return new Promise(function(e,t){var n=userPool.getCurrentUser();n||location.reload(),n.getSession(function(n,o){if(n)return void t({statusCode:401,message:"Unauthorized"});session_id=o.getAccessToken().getJwtToken(),e(session_id)})})}function getStatus(){return get(endpoint.status).then(function(e){return maintenance=e.body.maintenance,userStatus=e.body.user,Promise.resolve()})}function get(e){return new Promise(function(t,n){request.get(e).set("Authorization",session_id).end(function(e,o){e&&n(e),t(o)})})}function post(e,t){var t=void 0===t?{}:t;return new Promise(function(n,o){request.post(e).set("Authorization",session_id).send(t).end(function(e,t){e&&o(e),n(t)})})}function put(e,t){var t=void 0===t?{}:t;return new Promise(function(n,o){request.put(e).set("Authorization",session_id).send(t).end(function(e,t){e&&o(e),n(t)})})}function del(e,t){var t=void 0===t?{}:t;return new Promise(function(n,o){request.del(e).set("Authorization",session_id).send(t).end(function(e,t){e&&o(e),n(t)})})}function display(){$("#loading").addClass("hidden"),$("#main_box").removeClass("hidden")}function loading(){function e(){var e=$(window).height(),t=$("#loading").offset(),n=t.top,o=e-n;$("#loading").height(o)}$("#loading").removeClass("hidden"),e(),$(window).resize(function(){e()})}function notifyUnregistedCreditCard(){swal({title:"Required",text:" Please register billing information to begin using Shifter.",confirmButtonColor:"#dc2d69",confirmButtonText:"Regist Credit Cards",showCancelButton:!0,closeOnConfirm:!0},function(e){e&&riot.route("/billing"),swal.close()})}function editable(e){$.fn.editable.defaults.mode="inline",$.fn.editable.defaults.ajaxOptions={type:"PUT",headers:{Authorization:session_id},dataType:"json"},$(e).editable()}riot.compile(function(){riot.mount("*");var e=riot.router.Route,t=riot.router.DefaultRoute,n=riot.router.NotFoundRoute;riot.router.RedirectRoute;riot.router.use(securityFilter),riot.router.routes([new t({tag:"login"}),new e({tag:"projects"}),new e({path:"/project_new/:archive_id",tag:"project_new"}),new e({path:"/project_new",tag:"project_new"}),new e({path:"/project_detail/:project_id",tag:"project_detail"}),new e({tag:"archive"}),new e({tag:"billing"}),new e({path:"/activation/:username/:code",tag:"activation"}),new e({tag:"domains"}),new e({tag:"archive-tool"}),new e({path:"/userinfo-activation/:code",tag:"userinfo-activation"}),new e({tag:"register"}),new e({tag:"forgot_password"}),new e({path:"/reset_password/:username/:code",tag:"reset_password"}),new e({tag:"account"}),new n({tag:"not-found"})]),riot.router.start()}),null!==cognitoUser&&(sessionRefrashProvider=setInterval(function(){cognitoUser.getSession(function(e,t){e||(session_id=t.getAccessToken().getJwtToken())})},9e5));